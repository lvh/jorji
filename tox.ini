[tox]
envlist = py27,pypy

[testenv]
deps =
     -r{toxinidir}/requirements.txt
commands =
    coverage run \
        {envdir}/bin/trial \
            --temp-directory={envdir}/_trial \
            {posargs:jorji}

    coverage report --show-missing
    coverage html --directory {envdir}/coverage

    check-manifest --ignore .coveragerc,.travis.yml,tox.ini
    pyflakes jorji
    pep8 jorji
    pep257 jorji

    pip-review
    # Work around a bug in pyroma where it returns 1 when it should
    # return 0, causing tox to believe it failed.
    # https://bitbucket.org/regebro/pyroma/issue/18
    sh -c <<EOT {envbindir}/pyroma . || (( $? == 1 )) EOT
whitelist_externals = sh
